<!DOCTYPE html>
<html lang="en">

<head>
	<title>metasophiea</title>
	<meta charset="utf-8"></meta>
    <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline' ">
    
    <link href="https://fonts.googleapis.com/css?family=Lobster" rel="stylesheet">

    <script src="./audioMachine.js"></script>
    <script src="./tracks.js"></script>
	<script>
        var AudioContext = new window.AudioContext();
        var digitCount = 9;
        var calculatorValues = [0,0,0,0,0,0,0,0,0];
        var calculatorValues_inputNumber = [0,0,0,0,0,0,0,0,0];

        var audioMachines = [];
        for(var a = 0; a < digitCount; a++){
            audioMachines[a] = new audioMachine(AudioContext);
            audioMachines[a].loadAudio(tracks[a]);
        }

        function Go(){
            var startX = 70; var startY = 11;
            var thickness = 1; var length = 3; var spacing = 1;

            for(var a = 0; a < 9; a++){
                document.getElementById('LCD_'+a+'_0').setAttribute('height',thickness);
                document.getElementById('LCD_'+a+'_0').setAttribute('width',length);
                document.getElementById('LCD_'+a+'_0').setAttribute('y',startY);
                document.getElementById('LCD_'+a+'_0').setAttribute('x',startX-(a*(length+thickness*2+spacing)));

                document.getElementById('LCD_'+a+'_1').setAttribute('height',length);
                document.getElementById('LCD_'+a+'_1').setAttribute('width',thickness);
                document.getElementById('LCD_'+a+'_1').setAttribute('y',startY+thickness);
                document.getElementById('LCD_'+a+'_1').setAttribute('x',startX-thickness-(a*(length+thickness*2+spacing)));

                document.getElementById('LCD_'+a+'_2').setAttribute('height',length);
                document.getElementById('LCD_'+a+'_2').setAttribute('width',thickness);
                document.getElementById('LCD_'+a+'_2').setAttribute('y',startY+thickness);
                document.getElementById('LCD_'+a+'_2').setAttribute('x',startX+length-(a*(length+thickness*2+spacing)));

                document.getElementById('LCD_'+a+'_3').setAttribute('height',thickness);
                document.getElementById('LCD_'+a+'_3').setAttribute('width',length);
                document.getElementById('LCD_'+a+'_3').setAttribute('y',startY+length+thickness);
                document.getElementById('LCD_'+a+'_3').setAttribute('x',startX-(a*(length+thickness*2+spacing)));

                document.getElementById('LCD_'+a+'_4').setAttribute('height',length);
                document.getElementById('LCD_'+a+'_4').setAttribute('width',thickness);
                document.getElementById('LCD_'+a+'_4').setAttribute('y',startY+length+thickness*2);
                document.getElementById('LCD_'+a+'_4').setAttribute('x',startX-thickness-(a*(length+thickness*2+spacing)));

                document.getElementById('LCD_'+a+'_5').setAttribute('height',length);
                document.getElementById('LCD_'+a+'_5').setAttribute('width',thickness);
                document.getElementById('LCD_'+a+'_5').setAttribute('y',startY+length+thickness*2);
                document.getElementById('LCD_'+a+'_5').setAttribute('x',startX+length-(a*(length+thickness*2+spacing)));

                document.getElementById('LCD_'+a+'_6').setAttribute('height',thickness);
                document.getElementById('LCD_'+a+'_6').setAttribute('width',length);
                document.getElementById('LCD_'+a+'_6').setAttribute('y',startY+length*2+thickness*2);
                document.getElementById('LCD_'+a+'_6').setAttribute('x',startX-(a*(length+thickness*2+spacing)));
            }

            

            setTimeout(function(){ 
                for(var a = 0; a < 9; a++){ 
                    audioMachines[a].go();
                }
                update();
            }, 1000);
        }

        var calculationAction = null; var equalsPressedLast = true;
        function buttonPress(buttonAction){
            switch(buttonAction){
                case '0': case '1': case '2': case '3': case '4': case '5': case '6': case '7': case '8': case '9': 
                    if(equalsPressedLast){ calculatorValues = shiftIn(buttonAction,calculatorValues); }
                    else{ calculatorValues_inputNumber = shiftIn(buttonAction,calculatorValues_inputNumber); }
                break;

                case '+': case '-':  case '*': case '/': 
                    equalsPressedLast = false;
                    calculationAction = buttonAction;
                break;

                case 'Cl': 
                    calculationAction = null;
                    calculatorValues = [0,0,0,0,0,0,0,0,0];
                    calculatorValues_inputNumber = [0,0,0,0,0,0,0,0,0];
                break;
                case '=': 
                    //perform calculation, and convert into an array
                    var ans = 0;
                    switch(calculationAction){
                        case '+': ans = parseInt(calculatorValues.reverse().join('')) + parseInt(calculatorValues_inputNumber.reverse().join('')); break;
                        case '-': ans = parseInt(calculatorValues.reverse().join('')) - parseInt(calculatorValues_inputNumber.reverse().join('')); break;
                        case '*': ans = parseInt(calculatorValues.reverse().join('')) * parseInt(calculatorValues_inputNumber.reverse().join('')); break;
                        case '/': ans = parseInt(calculatorValues.reverse().join('')) / parseInt(calculatorValues_inputNumber.reverse().join('')); break;
                    }
                    ans = Math.floor(ans);
                    ans = ans.toString();
                    while(ans.length < 9){ ans = "0" + ans; }
                    ans = ans.split('').reverse();

                    //update/clear arrays
                    for(var a = 0; a < ans.length; a++){ calculatorValues[a] = ans[a]; }
                    calculatorValues_inputNumber.reverse();
                    equalsPressedLast = true;
                break;
            }
            update();
        }

        function shiftIn(value, values){
            for(var a = values.length-1; a > 0; a--){
                values[a] = values[a-1];
            }
            values[0] = value;
            return values;
        }

        function update(){
            //update LCD and audioMachines
            for(var a = 0; a < 9; a++){ 
                if(equalsPressedLast){setLCD(a,calculatorValues[a]);}
                else{setLCD(a,calculatorValues_inputNumber[a]);}
                audioMachines[a].switchToTrack(calculatorValues[a]);
            }
        }

        function setLCD(digit,value){
            var segmentArray = [1,1,1,0,1,1,1];
            switch(value){
                case 0: case '0': segmentArray = [1,1,1,0,1,1,1]; break;
				case 1: case '1': segmentArray = [0,0,1,0,0,1,0]; break;
				case 2: case '2': segmentArray = [1,0,1,1,1,0,1]; break;
				case 3: case '3': segmentArray = [1,0,1,1,0,1,1]; break;
				case 4: case '4': segmentArray = [0,1,1,1,0,1,0]; break;
				case 5: case '5': segmentArray = [1,1,0,1,0,1,1]; break;
				case 6: case '6': segmentArray = [1,1,0,1,1,1,1]; break;
				case 7: case '7': segmentArray = [1,0,1,0,0,1,0]; break;
				case 8: case '8': segmentArray = [1,1,1,1,1,1,1]; break;
				case 9: case '9': segmentArray = [1,1,1,1,0,1,0]; break;
            }

            for(var a = 0; a < 7; a++){
                if(segmentArray[a] == 1){ document.getElementById('LCD_'+digit+'_'+a).setAttribute('class','LCD_'+digit+'_lit'); }
                else{ document.getElementById('LCD_'+digit+'_'+a).setAttribute('class','LCD_'+digit+'_dark'); }
            }

        }

    </script>

	<style>
        .fancyText{
            fill: rgb(247,217,24); 
            font-family: 'Lobster', cursive;
            font-size: 4px;
        }

        .button_base{fill: rgb(220,220,220);}
        .button_symbol{
            fill: rgb(0,0,0); 
            font-family: 'Helvetica Neue Light', 'HelveticaNeue-Light', 'Helvetica Neue', Helvetica, Arial, sans-serif;
            font-size: 8px;
        }
        .button_cover{fill: rgba(0,0,0,0);}
        .button_cover:hover{fill: rgba(255,255,255,.5);}
        .LCD_background{fill:rgb(40,40,40);}
        .LCD_0_dark{fill: rgb(0,100,0);}
        .LCD_1_dark{fill: rgb(0,100,0);}
        .LCD_2_dark{fill: rgb(0,100,0);}
        .LCD_3_dark{fill: rgb(0,100,0);}
        .LCD_4_dark{fill: rgb(0,100,0);}
        .LCD_5_dark{fill: rgb(0,100,0);}
        .LCD_6_dark{fill: rgb(0,100,0);}
        .LCD_7_dark{fill: rgb(0,100,0);}
        .LCD_8_dark{fill: rgb(0,100,0);}

        .LCD_0_lit{fill: rgb(0,200,0);}
        .LCD_1_lit{fill: rgb(0,200,0);}
        .LCD_2_lit{fill: rgb(0,200,0);}
        .LCD_3_lit{fill: rgb(0,200,0);}
        .LCD_4_lit{fill: rgb(0,200,0);}
        .LCD_5_lit{fill: rgb(0,200,0);}
        .LCD_6_lit{fill: rgb(0,200,0);}
        .LCD_7_lit{fill: rgb(0,200,0);}
        .LCD_8_lit{fill: rgb(0,200,0);}
    </style>
</head>

<body onload='Go()'>

	<svg id='SVG_Space' style='height:100%; width:100%;' viewbox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'>
		<rect height='100' width='65' y='0' x='15' fill='rgb(240,240,240)'/>

        <!-- extra text -->
            <text class='fancyText' x="20" y="95">partyCalculator</text>

        <!-- buttons -->
            <!-- base -->
                <rect id='button_0'  class='button_base' height='14' width='14' y='30' x='18'/>
                <rect id='button_1'  class='button_base' height='14' width='14' y='30' x='33'/>
                <rect id='button_2'  class='button_base' height='14' width='14' y='30' x='48'/>
                <rect id='button_3'  class='button_base' height='14' width='14' y='30' x='63'/>
                <rect id='button_4'  class='button_base' height='14' width='14' y='45' x='18'/>
                <rect id='button_5'  class='button_base' height='14' width='14' y='45' x='33'/>
                <rect id='button_6'  class='button_base' height='14' width='14' y='45' x='48'/>
                <rect id='button_7'  class='button_base' height='14' width='14' y='45' x='63'/>
                <rect id='button_8'  class='button_base' height='14' width='14' y='60' x='18'/>
                <rect id='button_9'  class='button_base' height='14' width='14' y='60' x='33'/>
                <rect id='button_10'  class='button_base' height='14' width='14' y='60' x='48'/>
                <rect id='button_11'  class='button_base' height='14' width='14' y='60' x='63'/>
                <rect id='button_12'  class='button_base' height='14' width='14' y='75' x='18'/>
                <rect id='button_13'  class='button_base' height='14' width='14' y='75' x='33'/>
                <rect id='button_14'  class='button_base' height='14' width='14' y='75' x='48'/>
                <rect id='button_15'  class='button_base' height='14' width='14' y='75' x='63'/>
            <!-- symbol -->
                <text class='button_symbol' x="23" y="40">7</text>
                <text class='button_symbol' x="38" y="40">8</text>
                <text class='button_symbol' x="53" y="40">9</text>
                <text class='button_symbol' x="68" y="40">+</text>
                <text class='button_symbol' x="23" y="55">4</text>
                <text class='button_symbol' x="38" y="55">5</text>
                <text class='button_symbol' x="53" y="55">6</text>
                <text class='button_symbol' x="68" y="55">-</text>
                <text class='button_symbol' x="23" y="70">1</text>
                <text class='button_symbol' x="38" y="70">2</text>
                <text class='button_symbol' x="53" y="70">3</text>
                <text class='button_symbol' x="68" y="70">*</text>
                <text class='button_symbol' x="21.5" y="85">Cl</text>
                <text class='button_symbol' x="38" y="85">0</text>
                <text class='button_symbol' x="52.5" y="84">=</text>
                <text class='button_symbol' x="68" y="85">/</text>
            
            <!-- cover -->
                <rect id='button_0'  class='button_cover' height='14' width='14' y='30' x='18' onclick='buttonPress("7")'/>
                <rect id='button_1'  class='button_cover' height='14' width='14' y='30' x='33' onclick='buttonPress("8")'/>
                <rect id='button_2'  class='button_cover' height='14' width='14' y='30' x='48' onclick='buttonPress("9")'/>
                <rect id='button_3'  class='button_cover' height='14' width='14' y='30' x='63' onclick='buttonPress("+")'/>
                <rect id='button_4'  class='button_cover' height='14' width='14' y='45' x='18' onclick='buttonPress("4")'/>
                <rect id='button_5'  class='button_cover' height='14' width='14' y='45' x='33' onclick='buttonPress("5")'/>
                <rect id='button_6'  class='button_cover' height='14' width='14' y='45' x='48' onclick='buttonPress("6")'/>
                <rect id='button_7'  class='button_cover' height='14' width='14' y='45' x='63' onclick='buttonPress("-")'/>
                <rect id='button_8'  class='button_cover' height='14' width='14' y='60' x='18' onclick='buttonPress("1")'/>
                <rect id='button_9'  class='button_cover' height='14' width='14' y='60' x='33' onclick='buttonPress("2")'/>
                <rect id='button_10' class='button_cover' height='14' width='14' y='60' x='48' onclick='buttonPress("3")'/>
                <rect id='button_11' class='button_cover' height='14' width='14' y='60' x='63' onclick='buttonPress("*")'/>
                <rect id='button_12' class='button_cover' height='14' width='14' y='75' x='18' onclick='buttonPress("Cl")'/>
                <rect id='button_13' class='button_cover' height='14' width='14' y='75' x='33' onclick='buttonPress("0")'/>
                <rect id='button_14' class='button_cover' height='14' width='14' y='75' x='48' onclick='buttonPress("=")'/>
                <rect id='button_15' class='button_cover' height='14' width='14' y='75' x='63' onclick='buttonPress("/")'/>


        <!-- LCD Screen -->
            <rect class='LCD_background' height='15' width='59' y='8' x='18'/>
            
            <rect id='LCD_0_0' class='LCD_0_dark'/>
            <rect id='LCD_0_1' class='LCD_0_dark'/>
            <rect id='LCD_0_2' class='LCD_0_dark'/>
            <rect id='LCD_0_3' class='LCD_0_dark'/>
            <rect id='LCD_0_4' class='LCD_0_dark'/>
            <rect id='LCD_0_5' class='LCD_0_dark'/>
            <rect id='LCD_0_6' class='LCD_0_dark'/>

            <rect id='LCD_1_0' class='LCD_1_dark'/>
            <rect id='LCD_1_1' class='LCD_1_dark'/>
            <rect id='LCD_1_2' class='LCD_1_dark'/>
            <rect id='LCD_1_3' class='LCD_1_dark'/>
            <rect id='LCD_1_4' class='LCD_1_dark'/>
            <rect id='LCD_1_5' class='LCD_1_dark'/>
            <rect id='LCD_1_6' class='LCD_1_dark'/>

            <rect id='LCD_2_0' class='LCD_2_dark'/>
            <rect id='LCD_2_1' class='LCD_2_dark'/>
            <rect id='LCD_2_2' class='LCD_2_dark'/>
            <rect id='LCD_2_3' class='LCD_2_dark'/>
            <rect id='LCD_2_4' class='LCD_2_dark'/>
            <rect id='LCD_2_5' class='LCD_2_dark'/>
            <rect id='LCD_2_6' class='LCD_2_dark'/>

            <rect id='LCD_3_0' class='LCD_3_dark'/>
            <rect id='LCD_3_1' class='LCD_3_dark'/>
            <rect id='LCD_3_2' class='LCD_3_dark'/>
            <rect id='LCD_3_3' class='LCD_3_dark'/>
            <rect id='LCD_3_4' class='LCD_3_dark'/>
            <rect id='LCD_3_5' class='LCD_3_dark'/>
            <rect id='LCD_3_6' class='LCD_3_dark'/>

            <rect id='LCD_4_0' class='LCD_4_dark'/>
            <rect id='LCD_4_1' class='LCD_4_dark'/>
            <rect id='LCD_4_2' class='LCD_4_dark'/>
            <rect id='LCD_4_3' class='LCD_4_dark'/>
            <rect id='LCD_4_4' class='LCD_4_dark'/>
            <rect id='LCD_4_5' class='LCD_4_dark'/>
            <rect id='LCD_4_6' class='LCD_4_dark'/>

            <rect id='LCD_5_0' class='LCD_5_dark'/>
            <rect id='LCD_5_1' class='LCD_5_dark'/>
            <rect id='LCD_5_2' class='LCD_5_dark'/>
            <rect id='LCD_5_3' class='LCD_5_dark'/>
            <rect id='LCD_5_4' class='LCD_5_dark'/>
            <rect id='LCD_5_5' class='LCD_5_dark'/>
            <rect id='LCD_5_6' class='LCD_5_dark'/>

            <rect id='LCD_6_0' class='LCD_6_dark'/>
            <rect id='LCD_6_1' class='LCD_6_dark'/>
            <rect id='LCD_6_2' class='LCD_6_dark'/>
            <rect id='LCD_6_3' class='LCD_6_dark'/>
            <rect id='LCD_6_4' class='LCD_6_dark'/>
            <rect id='LCD_6_5' class='LCD_6_dark'/>
            <rect id='LCD_6_6' class='LCD_6_dark'/>

            <rect id='LCD_7_0' class='LCD_7_dark'/>
            <rect id='LCD_7_1' class='LCD_7_dark'/>
            <rect id='LCD_7_2' class='LCD_7_dark'/>
            <rect id='LCD_7_3' class='LCD_7_dark'/>
            <rect id='LCD_7_4' class='LCD_7_dark'/>
            <rect id='LCD_7_5' class='LCD_7_dark'/>
            <rect id='LCD_7_6' class='LCD_7_dark'/>

            <rect id='LCD_8_0' class='LCD_8_dark'/>
            <rect id='LCD_8_1' class='LCD_8_dark'/>
            <rect id='LCD_8_2' class='LCD_8_dark'/>
            <rect id='LCD_8_3' class='LCD_8_dark'/>
            <rect id='LCD_8_4' class='LCD_8_dark'/>
            <rect id='LCD_8_5' class='LCD_8_dark'/>
            <rect id='LCD_8_6' class='LCD_8_dark'/>

	</svg>

</body>
</html>