<!DOCTYPE html>
<html lang="en">

<head>
	<title>metasophiea</title>
	<meta charset="utf-8"></meta>
	<link rel="icon" href="https://metasophiea.com/lib/image/icon.gif" type="image/gif"></link>
	<script type="text/javascript" src="https://metasophiea.com/lib/js/pixelMagic/0.1.2/pixelMagic.js"></script>
	<script type='text/javascript' src="https://metasophiea.com/mainSite/content/articles2.js"></script>
	<script>
		var log = []; var scroll = 0; 
		var workingCode = ''; var flash = false; var flashCount = 0;

		function adjustCanvas(canvas){
			if(window.innerHeight > window.innerWidth){canvas.height = window.innerWidth;canvas.width = window.innerWidth;}
			else{canvas.height = window.innerHeight;canvas.width = window.innerHeight;}
		}
		function printStartingText(){
			var lines = [
				{'text':'loading drivers..','colour':'888888'},
				{'text':'stabilizing matrix generators..','colour':'888888'},
				{'text':'greeting double ETC connections..','colour':'888888'},
				{'text':'conneting..','colour':'888888'},
				{'text':'ready','colour':'888888'},
				{'text':' ','colour':'ffffff'},
				{'text':'  Metasophiea.com - NCC1700 Edition','colour':'ffffff'},
				{'text':' ','colour':'ffffff'},
				{'text':'type help for help','colour':'ffffff'},
			];

			var maxTime = 0;
			for(var a = 0; a < lines.length; a++){
				var time = 1000+Math.floor(Math.random()*3000); if(maxTime < time){maxTime = time;}
				setTimeout(function(){addLine(lines.shift());},time);	
			}
			setTimeout(function(){document.body.setAttribute('onkeydown','key(event.key)');},maxTime);
		}

		function Go(){
			console.log('hello');
			adjustCanvas(document.getElementById('pixelMatrix'));
			pixelMatrix.attachCanvas(document.getElementById('pixelMatrix'));
			pixelMatrix.screenDimensions({'width':200,'height':200});
			pixelMatrix.FPS(15);
			pixelMatrix.autoRender(true);
			printStartingText();

			setInterval(function(){render();},100);
		}

		function addLine(data){;
			if(pixelMatrix.drawString_calculateSize(data.text).width > pixelMatrix.screenDimensions().width){
				var lineArray = data.text.split(' '); var workingLine = [];
				for(var a = 0; a < lineArray.length; a++){
					workingLine.push(lineArray[a]);
					if(pixelMatrix.drawString_calculateSize(workingLine.join(' ')).width > pixelMatrix.screenDimensions().width){
						workingLine.pop(); a--; log.push({'text':workingLine.join(' '),'colour':data.colour}); workingLine = [];
					}
				}
				log.push({'text':workingLine.join(' '),'colour':data.colour});
			}
			else{log.push(data);}
		}

		function render(){
			pixelMatrix.setAllPixels('000000'); var height = 0;
			for(var a = 0; a < log.length; a++){
				height += pixelMatrix.drawString({'x':1,'y':scroll+height},log[a].text,log[a].colour).height;
			}
			if(height > pixelMatrix.screenDimensions().height-10){
				scroll = pixelMatrix.screenDimensions().height-10 - height;
			}

			var width = pixelMatrix.drawString({'x':1,'y':pixelMatrix.screenDimensions().height-6},workingCode,'ffffff').width;
			if(flash){pixelMatrix.drawString({'x':width+2,'y':pixelMatrix.screenDimensions().height-6},'|','ffffff');}
			if(flashCount > 4){flashCount = 0;if(flash){flash = false;}else{flash = true;}}
			flashCount++;
		}

		function key(data){
			switch(data){
				case 'Enter': log.push({'text':workingCode, 'colour':'000000'}); runCommand(workingCode); workingCode = ''; break;
				case 'Backspace': var temp = workingCode.split(''); temp.pop(); workingCode = temp.join(''); break;
				case ' ': case '.': case '/': case '\\': case '|': case ';': case ':':case '<': case '>': case '(': case ')': case '-': case '"': case "'": case ',':  case '+': case '#': case '?': case '_': case '!':
				case '0': case '1': case '2': case '3': case '4': case '5': case '6': case '7': case '8': case '9':
				case 'a': case 'b': case 'c': case 'd': case 'e': case 'f': case 'g': case 'h': case 'i': case 'j': case 'k': case 'l': case 'm': case 'n': case 'o': case 'p': case 'q': case 'r': case 's': case 't': case 'u': case 'v': case 'w': case 'x': case 'y': case 'z':
				case 'A': case 'B': case 'C': case 'D': case 'E': case 'F': case 'G': case 'H': case 'I': case 'J': case 'K': case 'L': case 'M': case 'N': case 'O': case 'P': case 'Q': case 'R': case 'S': case 'T': case 'U': case 'V': case 'W': case 'X': case 'Y': case 'Z':
				workingCode += data; break;
			}
		}
		function runCommand(command){
			var commandParts = command.split(' ');
			switch(commandParts[0]){
				case 'exit':window.history.back(); break;
				case 'reset': location.reload(); break;
				case 'clear': log = []; scroll = 0; break;
				case 'help': 
					addLine({'text':' ', 'colour':'000000'});
					addLine({'text':' --Help -- -- --', 'colour':'ffffff'});
					addLine({'text':'- help', 'colour':'aaaaaa'});
					addLine({'text':'- post ', 'colour':'aaaaaa'});
					addLine({'text':'- - list ', 'colour':'aaaaaa'});
					addLine({'text':'- - n view ', 'colour':'aaaaaa'});
					addLine({'text':'- - n go ', 'colour':'aaaaaa'});
					addLine({'text':'- clear', 'colour':'aaaaaa'});
					addLine({'text':'- con ', 'colour':'aaaaaa'});
					addLine({'text':'- reset', 'colour':'aaaaaa'});
					addLine({'text':'- exit', 'colour':'aaaaaa'});
					addLine({'text':' -- -- -- -- --', 'colour':'ffffff'});
				break;
				case 'con': eval(command.substring(4)); break;
				case 'post':
					if(commandParts[1] == 'list'){var temp = []; for(var a = 0; a < articles.length; a++){ temp.push(a); } addLine({'text':temp.join(' '), 'colour':'ffffff'});}
					else if(commandParts[1] >= articles.length || commandParts[1] < 0 || isNaN(commandParts[1])){addLine({'text':'bad article number','colour':'ff8888'}); return;}
					else if(commandParts[2] == 'go'){window.location = articles[commandParts[1]].link_url;}
					else if(commandParts[2] == 'view'){
						var article = articles[commandParts[1]];
						addLine({'text':' ', 'colour':'000000'});
						addLine({'text':article.headline, 'colour':'ffffff'});
						for(var a = 0; a < article.text.length; a++){
							addLine({'text':article.text[a], 'colour':'cccccc'});
						}
					}
					else{addLine({'text':'unknown command -> "' + command + '"', 'colour':'ff8888'});}
				break;
				default:log.push({'text':'unknown command -> "' + command + '"', 'colour':'ff8888'}); break;
			}
		}

	</script>
	<style>
		html,body{
			width:100%; height:100%; margin:0px;
			overflow-x: hidden; overflow-y: hidden;
			background-color:#101010;
		}
	</style>
</head>

<body onLoad="Go()">
	<canvas id='pixelMatrix' style='display: block; margin: auto; cursor: none;'></canvas>
</body>
</html>